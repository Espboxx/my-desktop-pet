# My Desktop Pet

这是一个桌面宠物应用程序，旨在为您的桌面带来一些乐趣和互动。

## 项目概述

该项目使用 Electron、React 和 TypeScript 构建。它在桌面上显示一个可交互的宠物角色。

## 主要功能

*   **桌面显示**: 宠物会出现在您的桌面上。
*   **互动**: 您可以与宠物进行互动。
*   **自定义**: （可选）未来可能支持自定义宠物外观或行为。
*   **状态系统**: 宠物有心情、精力等状态，会影响其行为。
*   **任务/成就**: 完成任务和解锁成就可以获得奖励。
*   **状态保存**: 宠物状态会自动保存和加载。

## 技术栈

*   **框架**: Electron, React
*   **语言**: TypeScript
*   **构建工具**: Vite

## 安装与运行

```bash
# 克隆仓库
git clone https://github.com/Espboxx/my-desktop-pet
cd my-desktop-pet

# 安装依赖
npm install

# 启动开发环境
npm run dev

# 构建应用
npm run build
```

## 项目进度

<!-- progress.md content start -->
# 桌面宠物项目进度跟踪

+## 开发日志 (2025-04-05)
+*   **已完成:** [UI/UX 优化] 完善设置窗口 UI - 在 `SettingsWindow.tsx` 中引入 `react-icons` 替换 Emoji 图标，并在 `SettingsWindow.css` 中优化了布局、颜色、间距和控件样式。
+*   **已完成:** [动画效果] 添加更多待机小动作 - 在 `PetWindow.css` 中添加了 `stretch-animation` 和 `idle-wiggle-animation`。在 `usePetStatus.ts` 中实现了随机调度这些动画的逻辑，并在 `PetWindow.tsx` 中应用。修复了相关的类型定义和上下文。
+*   **已完成:** [动画效果] 根据状态调整待机动画频率 - 在 `usePetStatus.ts` 中修改了 `scheduleBlink` 和 `scheduleIdleAnimation` 函数，根据心情和精力调整动画触发的随机延迟范围。
+*   **已完成:** [互动体验优化] 添加非等级成就 - 在 `petConstants.ts` 中添加了“互动新手”成就（累计互动 10 次）。确认 `usePetStatus.ts` 和 `usePetInteraction.ts` 中的检查逻辑已支持基于互动次数和状态阈值的成就。
+*   **已完成:** [互动体验优化] 实现成就解锁奖励 - 为“玩乐大师”成就添加了 `idleSpecial` 待机动画奖励，并更新状态和 UI 以支持随机显示。
+*   **已完成:** [任务/成就系统] 实现任务/成就 UI 基础显示 - 在设置窗口添加了新的标签页，用于展示当前活动任务和已解锁成就。通过 React Context API 实现了状态共享。
+*   **已完成:** [动画效果] 添加基础眨眼动画 - 在 `PetWindow.css` 中添加了 `@keyframes blink` 和 `.blink-animation` 类。在 `usePetStatus` Hook 中添加了随机触发眨眼的逻辑，并在 `PetWindow` 组件中应用了该动画类。更新了 `PetStatusContext` 以包含 `isBlinking` 状态。
+*   **已完成:** [互动体验优化] 实现宠物对悬停或快速移动的鼠标做出反应 - 在 `usePetInteraction.ts` 中添加了鼠标速度和悬停检测逻辑，管理 `reactionAnimation` 状态。在 `PetWindow.tsx` 中应用了该状态。在 `PetWindow.css` 中添加了 `tilt-head` (悬停) 和 `look-around-fast` (快速移动) 动画。
+*   **下一步计划:** [互动体验优化] 实现宠物追逐鼠标指针（当鼠标在宠物附近快速移动时，宠物尝试向鼠标方向移动一小段距离）。

## 已完成功能 (2025-04-04)
- [x] 基础宠物展示 (PetWindow组件)
- [x] 基础设置功能 (SettingsWindow组件)
- [x] 桌面活动能力
- [x] 鼠标点击互动
- [x] 鼠标拖拽互动 (优化为绝对定位, 修复缩放时交互问题)

## 当前工作 (核心功能开发) (2025-04-05)
### 宠物状态系统
- [x] 添加状态数据结构
- [x] 实现状态影响行为逻辑
- [x] 添加喂食互动功能
- [x] 添加清洁互动功能
- [x] 状态UI显示

### 互动系统
- [x] 实现玩耍互动

## 已完成优化 (2025-04-04)
- [x] 优化状态衰减算法
   - [x] 添加随机事件影响
   - [x] 添加昼夜变化影响
   - [x] 调整基础衰减速率
   - [x] 优化随机事件触发逻辑

## 下一步计划 (优先)
- [x] [UI/UX 优化] 完善设置窗口 UI，使其更美观易用（例如，调整布局、添加图标、优化控件样式）。(2025-04-05)

## 下一步计划 (其他)
1. 优化显示与交互
   - [x] 优化宠物显示 (使用Emoji表情)
   - [x] 完善动画反馈 (为不同交互添加不同动画)

2. 添加更多互动效果
   - [x] 添加特殊事件 (初步实现, 已添加生病事件)
   - [x] 实现更多互动类型
     - [x] 训练 (初步实现, 已根据精力优化)
     - [x] 学习 (初步实现, 已根据心情优化)
     - [x] 玩耍 (初步实现, 已根据精力优化)

3. 添加状态提示系统
   - [x] 低状态警告
   - [x] 状态变化动画
   - [x] 状态恢复效果

## 新功能开发 (2025-04-05)
### 宠物成长系统
- [x] 添加经验值和等级系统
- [x] 实现成长动画和效果
- [x] 添加等级解锁功能


### 任务/成就系统
- [x] 设计任务数据结构 (已在 src/types/petTypes.ts 添加类型定义) (2025-04-05)
- [x] 实现成就解锁逻辑 (已在 usePetStatus 和 usePetInteraction 中添加检查) (2025-04-05)
- [x] 定义具体任务数据及检查逻辑 (在 `taskData.ts` 添加任务, 在 `usePetStatus` 和 `usePetInteraction` 中集成检查) (2025-04-05)
- [x] 实现任务/成就 UI 显示 (在设置窗口添加基础显示) (2025-04-05)

### 状态保存优化 (2025-04-05)
- [x] **完善状态保存机制:**
  - [x] 重构状态管理，渲染进程为唯一状态源。
  - [x] 主进程实现原子写入（临时文件+重命名）以减少文件损坏风险。
  - [x] 渲染进程实现启动时加载、定时保存（每分钟）、退出时保存。
  - [x] 确保等级、经验等完整状态被保存。
- [x] **添加自动备份功能:**
  - [x] 主进程在保存新状态前自动备份旧状态文件 (`.bak`)。
  - [x] 主进程在加载主状态文件失败时尝试从备份恢复。

## 互动体验优化 (计划中)
- [x] **直接点击/轻扫互动:** 实现直接点击或在宠物身上滑动鼠标进行“抚摸”等积极互动，绕过右键菜单。 (2025-04-05)
- [ ] **多样化与情境化动画:**
  - [x] 为常见互动（抚摸、喂食等）增加随机动画变体。(2025-04-05)
  - [x] 根据宠物当前状态（心情、精力等）调整互动反应动画。(2025-04-05)
  - [x] 添加基础待机动画（随机眨眼）。(2025-04-05)
  - [x] 添加更多待机小动作（如伸懒腰、晃动）。(2025-04-05)
  - [x] 根据状态调整待机动画（如开心时眨眼更快，疲惫时动作更慢）。(2025-04-05)
- [ ] **简单成就与解锁机制:**
  - [x] 设计并实现基于互动次数或特定行为的**非等级**成就系统。(2025-04-05 - 添加“互动新手”成就，确认检查逻辑)
    - [x] 设计成就数据结构和基础解锁逻辑框架 (2025-04-05) - *主要是等级解锁框架*
    - [x] 实现**等级解锁**的检查与通知效果 (互动与表情) (2025-04-05)
    - [x] 实现**非等级成就**的具体检查与解锁效果 (添加互动计数和状态阈值检查逻辑) (2025-04-05)
  - [x] 完成成就可以解锁小奖励（如新待机动画、临时装饰、特殊提示）。(2025-04-05 - 实现待机动画奖励)
- [ ] **对鼠标指针的反应:**
  - [x] 实现宠物眼睛跟随鼠标指针。 (2025-04-05, 初步实现)
  - [x] 实现宠物对悬停或快速移动的鼠标做出反应（如歪头看、尝试触碰、追逐）。(2025-04-05)
  - [ ] 实现宠物追逐鼠标指针（当鼠标在宠物附近快速移动时，宠物尝试向鼠标方向移动一小段距离）。
- [x] **优化拖拽反馈:** (2025-04-05)
  - [x] 添加“被提起”状态的动画/表情。
  - [x] 实现拖拽过程中的轻微身体晃动效果。
  - [x] 添加“落地”时的缓冲动画。
<!-- progress.md content end -->

## 重要声明

**本项目完全由 AI 生成，包括但不限于：**

*   **roocode**
*   **Google Gemini 2.5**
*   **Anthropic Claude 3.7**
*   **DeepSeek V3**

**开发者没有手写一行代码。**

## 贡献

AI

## 许可证

（根据项目选择合适的许可证）
